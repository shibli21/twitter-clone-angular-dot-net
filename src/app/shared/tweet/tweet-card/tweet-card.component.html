<div
  class="hover:bg-gray-50 cursor-pointer border w-full transition rounded-md"
>
  <div
    class="border-b border-gray-300 px-2 md:px-4 py-2 items-center justify-between flex"
  >
    <div class="flex gap-2 items-start">
      <div class="overflow-hidden h-[40px] w-[40px] rounded-full">
        <img
          class="w-full h-full object-cover"
          [src]="
            tweet.user.profilePictureUrl
              ? tweet.user.profilePictureUrl
              : 'https://avatars.dicebear.com/api/open-peeps/' +
                tweet.user.userName +
                '.svg'
          "
        />
      </div>
      <div class="flex-row">
        <h1 class="text-base font-bold">
          {{ tweet.user.firstName }} {{ tweet.user.lastName }}
        </h1>
        <p class="text-gray-600 text-sm">
          @{{ tweet.user.userName }} · {{ tweet.createdAt | date }}
        </p>
      </div>
    </div>
    <div *ngIf="isCurrentUserId === tweet.user.id">
      <div class="flex items-center text-gray-600" *ngIf="!isRetweet">
        <button
          pButton
          type="button "
          icon="pi pi-pencil"
          class="p-button-sm p-button-text"
          (click)="showEditDialog()"
        ></button>
        <button
          pButton
          type="button"
          icon="pi pi-trash"
          class="p-button-danger p-button-sm p-button-text"
          (click)="deleteTweet()"
        ></button>
      </div>
    </div>
  </div>

  <div class="p-4" [routerLink]="['/tweet', tweet.id]">
    <quill-view-html [content]="tweet.tweet"></quill-view-html>

    <div *ngIf="tweet.type === 'Retweet'" class="">
      <app-tweet-card [tweet]="tweet.refTweet" [isRetweet]="true">
      </app-tweet-card>
    </div>
  </div>

  <div
    *ngIf="!isRetweet"
    class="flex py-2 md:py-3 px-2 md:px-6 border-t border-gray-300 text-gray-600"
  >
    <button
      pButton
      type="button"
      [icon]="tweet.isLiked ? 'pi pi-heart-fill' : 'pi pi-heart'"
      (click)="likeUnlike()"
      [label]="tweet.likeCount.toString()"
      class="p-button-danger p-button-text"
    ></button>
    <button
      pButton
      [label]="tweet.commentCount.toString()"
      type="button"
      icon="pi pi-comment"
      class="p-button-success p-button-text"
      (click)="showDialog()"
    ></button>
    <button
      pButton
      [label]="tweet.retweetCount.toString()"
      type="button"
      icon="pi pi-share-alt"
      class="p-button-help p-button-text"
      (click)="showRetweetDialog()"
    ></button>
  </div>
</div>

<p-dialog
  [(visible)]="display"
  [modal]="true"
  [breakpoints]="{ '960px': '600px' }"
  [style]="{ width: '600px' }"
  [baseZIndex]="10000"
  [draggable]="false"
  [resizable]="false"
  [dismissableMask]="true"
>
  <ng-template pTemplate="header">
    <div class="flex gap-2 items-start">
      <div class="overflow-hidden h-[40px] w-[40px] rounded-full">
        <img
          src="https://cdn.pixabay.com/photo/2016/11/18/23/38/child-1837375_960_720.png"
        />
      </div>
      <div class="flex-row">
        <h1 class="text-base font-bold">
          {{ tweet.user.firstName }} {{ tweet.user.lastName }}
        </h1>
        <p class="text-gray-600 text-sm">
          @{{ tweet.user.userName }} · {{ tweet.createdAt | date }}
        </p>
      </div>
    </div>
  </ng-template>

  <div class="mb-4 pb-2">
    <quill-view-html [content]="tweet.tweet"></quill-view-html>
  </div>

  <form (ngSubmit)="commentOnTweet()">
    <input
      name="newComment"
      [(ngModel)]="comment"
      placeholder="Tweet your reply"
      pInputText
    />
  </form>

  <ng-template pTemplate="footer">
    <p-button
      [disabled]="comment.length === 0"
      icon="pi pi-send"
      (click)="commentOnTweet()"
      label="Reply"
      class="p-button-text -mr-2"
      [loading]="isCommenting"
    ></p-button>
  </ng-template>
</p-dialog>

<p-dialog
  [(visible)]="displayEditDialog"
  [modal]="true"
  [breakpoints]="{ '960px': '600px' }"
  [style]="{ width: '600px' }"
  [baseZIndex]="10000"
  [draggable]="false"
  [resizable]="false"
  [dismissableMask]="true"
>
  <ng-template pTemplate="header">
    <div class="flex gap-2 items-start">
      <div class="overflow-hidden h-[40px] w-[40px] rounded-full">
        <img
          src="https://cdn.pixabay.com/photo/2016/11/18/23/38/child-1837375_960_720.png"
        />
      </div>
      <div class="flex-row">
        <h1 class="text-base font-bold">
          {{ tweet.user.firstName }} {{ tweet.user.lastName }}
        </h1>
        <p class="text-gray-600 text-sm">
          @{{ tweet.user.userName }} · {{ tweet.createdAt | date }}
        </p>
      </div>
    </div>
  </ng-template>

  <quill-editor
    class="w-full"
    theme="snow"
    placeholder="Retweet your reply..."
    customToolbarPosition="bottom"
    [(ngModel)]="editTweet"
    name="retweetText"
    [styles]="{
      height: 'auto',
      maxWidth: '600px',
      flexDirection: 'column-reverse !important'
    }"
  >
  </quill-editor>

  <ng-template pTemplate="footer">
    <p-button
      icon="pi pi-save"
      (click)="onEditTweet()"
      label="Save"
      [loading]="isEditing"
      class="p-button-text -mr-2"
    ></p-button>
  </ng-template>
</p-dialog>

<!-- retweet dialog -->

<p-dialog
  [(visible)]="retweetDisplay"
  [modal]="true"
  [breakpoints]="{ '960px': '600px' }"
  [style]="{ width: '600px' }"
  [baseZIndex]="10000"
  [draggable]="false"
  [resizable]="false"
  [dismissableMask]="true"
>
  <ng-template pTemplate="header">
    <div class="flex gap-2 items-start">
      <div class="overflow-hidden h-[40px] w-[40px] rounded-full">
        <img
          src="https://cdn.pixabay.com/photo/2016/11/18/23/38/child-1837375_960_720.png"
        />
      </div>
      <div class="flex-row">
        <h1 class="text-base font-bold">
          {{ tweet.user.firstName }} {{ tweet.user.lastName }}
        </h1>
        <p class="text-gray-600 text-sm">
          @{{ tweet.user.userName }} · {{ tweet.createdAt | date }}
        </p>
      </div>
    </div>
  </ng-template>

  <quill-editor
    class="w-full"
    theme="snow"
    placeholder="Retweet your reply..."
    customToolbarPosition="bottom"
    [(ngModel)]="retweetText"
    name="retweetText"
    [styles]="{
      height: 'auto',
      maxWidth: '600px',
      flexDirection: 'column-reverse !important'
    }"
  >
  </quill-editor>

  <div
    class="hover:bg-gray-50 cursor-pointer border w-full transition rounded-md"
  >
    <div
      class="border-b border-gray-300 px-2 md:px-4 py-2 items-center justify-between flex"
    >
      <div class="flex gap-2 items-start">
        <div class="overflow-hidden h-[40px] w-[40px] rounded-full">
          <img
            class="w-full h-full object-cover"
            [src]="
              tweet.user.profilePictureUrl
                ? tweet.user.profilePictureUrl
                : 'https://avatars.dicebear.com/api/open-peeps/' +
                  tweet.user.userName +
                  '.svg'
            "
          />
        </div>
        <div class="flex-row">
          <h1 class="text-base font-bold">
            {{ tweet.user.firstName }} {{ tweet.user.lastName }}
          </h1>
          <p class="text-gray-600 text-sm">
            @{{ tweet.user.userName }} · {{ tweet.createdAt | date }}
          </p>
        </div>
      </div>
    </div>

    <div class="p-4" [routerLink]="['/tweet', tweet.id]">
      <quill-view-html [content]="tweet.tweet"></quill-view-html>
    </div>
  </div>
  <!-- <p class="px-4">
    {{ tweet.tweet }}
  </p> -->

  <ng-template pTemplate="footer">
    <p-button
      icon="pi pi-share-alt"
      (click)="retweet()"
      label="Retweet"
      [loading]="isRetweeting"
      class="p-button-text -mr-2"
    ></p-button>
  </ng-template>
</p-dialog>
